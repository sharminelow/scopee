(function(){var g={};
(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Nb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Lb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=ca)}n("shaka.polyfill.CustomEvent.install",ba);function ca(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function da(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
ea);document.addEventListener("webkitfullscreenerror",ea);document.addEventListener("mozfullscreenchange",ea);document.addEventListener("mozfullscreenerror",ea);document.addEventListener("MSFullscreenChange",ea);document.addEventListener("MSFullscreenError",ea)}n("shaka.polyfill.Fullscreen.install",da);function ea(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function fa(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=ga)}n("shaka.polyfill.VideoPlaybackQuality.install",fa);function ga(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function ha(a){this.b=a;this.a=new ia(a);ja||(ja=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ja;
function r(a){var b;b=ka(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=ka(a);a:{for(d=0;d<ja.length;d++)if(la(c,ja[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);w(a.a,c);return new ma(b,d)}function ka(a){var b=na(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=na(a.a);return d}function ma(a,b){this.id=a;this.a=b}
function oa(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function pa(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function x(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=x.prototype.destroy;return c}x.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function z(a,b){return b.bind(a)};function qa(a){return Object.keys(a).map(function(b){return a[b]})}function ra(a,b){var c=sa(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function ua(a,b){return sa(a,b,"string")}function sa(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function va(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function wa(){return Date.now()+xa}var xa=0;var ya={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function za(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function Aa(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",Aa);function Ba(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",Ba);function Ca(a,b){var c=void 0==b?!0:b,d=window.btoa(Aa(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}n("shaka.util.Uint8ArrayUtils.toBase64",Ca);function Da(a){return Ba(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",Da);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function Ea(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",Ea);function la(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function A(){this.a={}}A.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};A.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function Fa(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function Ga(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function Ha(a){var b=[],c;for(c in a.a)b.push(c);return b};function Ia(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function Ka(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",Ka);function La(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function Ma(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function Na(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}Na.prototype.clone=function(){var a=new Na;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function Oa(){};function Pa(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Pa.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Qa(a){return a.b/(1-Math.pow(a.c,a.a))};function Ra(a,b,c){Sa(b);Sa(c);return c==b||a>=Ta&&c==b.split("-")[0]||a>=Ua&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Ta=1,Ua=2;function Sa(a){a=a.toLowerCase().split("-");var b=Va[a[0]];b&&(a[0]=b);return a.join("-")}
var Va={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function Wa(){this.a=new A}Wa.prototype.destroy=function(){Xa(this);this.a=null};function B(a,b,c,d){b=new Ya(b,c,d);a.a.push(c,b)}Wa.prototype.sa=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.sa(),Ga(this.a,b,e))}};function Xa(a){for(var b=Fa(a.a),c=0;c<b.length;++c)b[c].sa();a.a.a={}}function Ya(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Ya.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function C(a){this.xa=new A;this.v=a}n("shaka.util.FakeEventTarget",C);C.prototype.addEventListener=function(a,b,c){c||this.xa.push(a,b)};C.prototype.removeEventListener=function(a,b,c){c||Ga(this.xa,a,b)};C.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return Za(this,a)};
function Za(a,b){b.currentTarget=a;for(var c=a.xa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.v&&b.bubbles&&Za(a.v,b);return b.defaultPrevented};function $a(){this.g=new x;this.f=!1;this.a=null;this.b=[];this.c=null}function ab(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}$a.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});bb(this,void 0)};$a.prototype.end=function(){this.b.splice(1)};
function bb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(z(a,function(a){this.a?(this.b=[],this.c=null,cb(this)):(this.b.shift(),this.b.length?bb(this,a):(this.g.resolve(a),this.c=null))})).catch(z(a,function(a){this.b=[];this.c=null;this.a?cb(this):this.g.reject(a)}))}function cb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function db(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.j=a;this.c=b;this.v=c;this.h=new Wa;this.b=[];this.o=0;this.f=this.a=null;this.l=0;B(this.h,this.c,"updateend",this.w.bind(this))}var eb=1/60;db.prototype.destroy=function(){fb(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};
function gb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-eb,f=c.end(d)+eb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function hb(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new $a;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&ab(a.a,function(){return[ib(this,d),this.g.bind(this)]}.bind(a));ab(a.a,function(){var a=b.a?b.a-b.b:1,c=new jb;c.a=3;c.h=1E3*a;c.c=1E3*this.l;return[kb(b.url,c,this.v),D.prototype.g.bind(b.url)]}.bind(a));ab(a.a,z(a,function(a){this.v.getBandwidth();return[ib(this,a),this.g.bind(this)]}));var e=0==a.c.buffered.length&&
0==a.b.length,f=null;ab(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.i+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=lb(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return mb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function nb(a){if(a.a)return a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new $a;ab(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new x}return[a,this.g.bind(this)]}.bind(a));return mb(a)}
function ob(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new $a;ab(a.a,function(){return[pb(this,b),this.g.bind(this)]}.bind(a));return mb(a)}function fb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new x,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function mb(a){a.a.start();return a.a.g.then(z(a,function(){this.a=null})).catch(z(a,function(a){this.a=null;return Promise.reject(a)}))}
function ib(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new x;return a.f}function pb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=lb(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new x;return a.f}db.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};db.prototype.w=function(){this.f.resolve();this.f=null};function ia(a){var b=qb;this.b=a;this.c=b==rb;this.a=0}var qb=0,rb=1;function sb(a){return a.a<a.b.byteLength}function na(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function E(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function tb(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function ub(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function w(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function vb(a,b){C.call(this,b);this.a=null;this.h=a}q(vb,C);
function wb(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new x,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=z(a,function(a){this.a=a.target.result;xb(this,"group_store",{keyPath:"group_id"});xb(this,"stream_index_store",{keyPath:"stream_id"});a=xb(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=z(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function F(a){a.a&&(a.a.close(),a.a=null)}function xb(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function yb(a){return zb(a,"content_store")}function Ab(a){return zb(a,"stream_index_store")}function Bb(a){return zb(a,"group_store")}
function zb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Cb(a,b){var c=new x,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function G(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function H(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Db(){C.call(this,null);this.a=new Pa(3);this.c=new Pa(10);this.b=0}q(Db,C);n("shaka.util.EWMABandwidthEstimator",Db);Db.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(G({type:"bandwidth"}));this.b=Date.now()}};Db.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Qa(this.a),Qa(this.c))};Db.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
Db.prototype.supportsCaching=function(){return!1};function Eb(){vb.call(this,"readonly",null)}q(Eb,vb);function Gb(a){var b=new x,c=[],d=Bb(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Hb(a,b){return Cb(Bb(a),b).then(z(a,function(a){a.session_ids=pa(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Ib(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function Ib(a,b){return Cb(Ab(a),b)}function Jb(a,b,c){return Cb(yb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Kb(){this.h=this.a="";this.j=!1;this.o=this.l=null;this.v=this.g=!1;this.i=this.f="";this.c=null;this.b=[]}
function Lb(a){var b=new Kb;if(!a)return b;var c=ua(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=ua(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=sa(a,"withCredentials","boolean");null!=c&&(b.j=c);c=va(a,"licensePostProcessor",Function);null!=c&&(b.l=c);c=va(a,"licensePreProcessor",Function);null!=c&&(b.o=c);c=sa(a,"distinctiveIdentifierRequired","boolean");null!=
c&&(b.g=c);c=sa(a,"persistentStateRequired","boolean");null!=c&&(b.v=c);c=ua(a,"audioRobustness");null!=c&&(b.f=c);c=ua(a,"videoRobustness");null!=c&&(b.i=c);c=va(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=va(a,"initData",Object)){a=va(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=ua(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function Mb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=pa(c,function(a){return Array.prototype.join.apply(a.initData)+","+a.initDataType})};function Nb(a,b,c,d,e,f,g,h,k,m,p){this.g=a;this.j=b;this.o=c;this.a=[];this.h=e||null;this.i=f||null;this.f=g==Ob;this.v=h==Pb;this.c=k||"";this.l=m||"";this.b=p||null;d&&this.a.push(d)}n("shaka.player.DrmSchemeInfo",Nb);var Ob=1;Nb.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:Ob};var Pb=1;Nb.PersistentState={OPTIONAL:0,REQUIRED:Pb};Nb.createUnencrypted=function(){return new Nb("","",!1,null)};function Qb(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}Qb("error");Qb("warn");Qb("info");Qb("log");Qb("debug");function Rb(){return Promise.reject(Error("The key system specified is not supported."))}function Sb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Tb(){throw new TypeError("Illegal constructor.");}Tb.prototype.createSession=function(){};Tb.prototype.setServerCertificate=function(){};function Ub(){throw new TypeError("Illegal constructor.");}Ub.prototype.getConfiguration=function(){};Ub.prototype.createMediaKeys=function(){};function Vb(a,b){try{var c=new Wb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Xb(a){var b=this.mediaKeys;b&&b!=a&&Yb(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Yb(a,this);return Promise.resolve()}
function Wb(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},k=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var p=g.audioCapabilities[m];
p.contentType&&(k=!0,e.canPlayType(p.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)p=g.videoCapabilities[m],p.contentType&&(k=!0,e.canPlayType(p.contentType,this.a)&&(h.videoCapabilities.push(p),d=!0));k||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}Wb.prototype.createMediaKeys=function(){var a=new Zb(this.a);return Promise.resolve(a)};Wb.prototype.getConfiguration=function(){return this.b};function Zb(a){this.g=a;this.b=null;this.a=new Wa;this.c=[];this.f={}}function Yb(a,b){a.b=b;Xa(a.a);b&&(B(a.a,b,"webkitneedkey",a.Ab.bind(a)),B(a.a,b,"webkitkeymessage",a.zb.bind(a)),B(a.a,b,"webkitkeyadded",a.xb.bind(a)),B(a.a,b,"webkitkeyerror",a.yb.bind(a)))}l=Zb.prototype;
l.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new $b(a,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};l.Ab=function(a){a=G({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
l.zb=function(a){var b=ac(this,a.sessionId);b&&(a=G({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};l.xb=function(a){if(a=ac(this,a.sessionId))bc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
l.yb=function(a){var b=ac(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?bc(b,"output-restricted"):1==c?bc(b,"expired"):bc(b,"internal-error"))}};
function ac(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function $b(a,b,c){C.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new x;this.keyStatuses=new cc}q($b,C);
function dc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=Ba("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Ba("PERSISTENT|"+Aa(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new x;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}l=$b.prototype;l.Ia=function(a,b){if(this.a)this.a.then(this.Ia.bind(this,a,b)).catch(this.Ia.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=Aa(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=Da(d.keys[0].k),d=Da(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function bc(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=G({type:"keystatuseschange"});a.dispatchEvent(c)}l.generateRequest=function(a,b){return dc(this,b,null)};l.load=function(a){return"persistent-license"==this.g?dc(this,null,a):Promise.reject(Error("Not a persistent session."))};l.update=function(a){var b=new x;this.Ia(b,a);return b};
l.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};l.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function ec(a){this.b=a;this.a=0}
ec.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function cc(){this.size=0;this.a=void 0}var fc;l=cc.prototype;l.entries=function(){var a=fc,b=[];this.a&&b.push([a,this.a]);return new ec(b)};l.forEach=function(a){this.a&&a(this.a)};l.get=function(a){if(this.has(a))return this.a};l.has=function(a){var b=fc;return this.a&&la(new Uint8Array(a),b)?!0:!1};l.keys=function(){var a=fc,b=[];this.a&&b.push(a);return new ec(b)};
l.values=function(){var a=[];this.a&&a.push(this.a);return new ec(a)};function gc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(fc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=Vb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Xb,window.MediaKeys=Zb,window.MediaKeySystemAccess=Wb):(Navigator.prototype.requestMediaKeySystemAccess=Rb,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Sb,window.MediaKeys=Tb,window.MediaKeySystemAccess=Ub))}n("shaka.polyfill.MediaKeys.install",gc);n("shaka.polyfill.installAll",function(){ba();da();gc();fa()});function hc(a){this.systemIds=[];this.cencKeyIds=[];a=new ia(new DataView(a.buffer));try{for(;sb(a);){var b=a.a,c=E(a),d=E(a);1==c?c=tb(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)w(a,c-(a.a-b));else{var e=na(a);if(1<e)w(a,c-(a.a-b));else{w(a,3);var f=Ea(ub(a)),g=[];if(0<e)for(var h=E(a),k=0;k<h;++k){var m=Ea(ub(a));g.push(m)}var p=E(a);w(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&w(a,c-(a.a-b))}}}}catch(t){}};function I(){this.fontSize="100%";this.fontColor=ic;this.fontOpacity=jc;this.backgroundColor=kc;this.backgroundOpacity=jc;this.fontEdge=lc}n("shaka.player.TextStyle",I);I.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};I.prototype.load=I.prototype.a;I.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
I.prototype.store=I.prototype.b;function mc(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+nc(a.fontColor,a.fontOpacity));b.push("background-color: "+nc(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(nc(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function nc(a,b){return"rgba("+a.concat(b).join(",")+")"}var ic=[255,255,255],kc=[0,0,0];
I.StandardColors={WHITE:ic,BLACK:kc,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var jc=1;I.StandardOpacities={OPAQUE:jc,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var lc=[];
I.EdgeStyles={NONE:lc,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function oc(a){pc[a]={na:qc(),end:NaN}}function rc(a){if(a=pc[a])a.end=qc()}function sc(a){return(a=pc[a])&&a.end?a.end-a.na:NaN}var qc=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,pc={};var tc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function J(a){var b;a instanceof J?(uc(this,a.R),this.aa=a.aa,this.P=a.P,vc(this,a.fa),this.N=a.N,wc(this,a.a.clone()),this.$=a.$):a&&(b=String(a).match(tc))?(uc(this,b[1]||"",!0),this.aa=xc(b[2]||""),this.P=xc(b[3]||"",!0),vc(this,b[4]),this.N=xc(b[5]||"",!0),wc(this,b[6]||"",!0),this.$=xc(b[7]||"")):this.a=new yc(null)}l=J.prototype;l.R="";l.aa="";l.P="";l.fa=null;l.N="";l.$="";
l.toString=function(){var a=[],b=this.R;b&&a.push(zc(b,Ac,!0),":");if(b=this.P){a.push("//");var c=this.aa;c&&a.push(zc(c,Ac,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.fa;null!=b&&a.push(":",String(b))}if(b=this.N)this.P&&"/"!=b.charAt(0)&&a.push("/"),a.push(zc(b,"/"==b.charAt(0)?Bc:Cc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.$)&&a.push("#",zc(b,Dc));return a.join("")};
l.resolve=function(a){var b=this.clone();"data"===b.R&&(b=new J);var c=!!a.R;c?uc(b,a.R):c=!!a.aa;c?b.aa=a.aa:c=!!a.P;c?b.P=a.P:c=null!=a.fa;var d=a.N;if(c)vc(b,a.fa);else if(c=!!a.N){if("/"!=d.charAt(0))if(this.P&&!this.N)d="/"+d;else{var e=b.N.lastIndexOf("/");-1!=e&&(d=b.N.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.N=d:c=""!==a.a.toString();c?wc(b,a.a.clone()):c=!!a.$;c&&(b.$=a.$);return b};l.clone=function(){return new J(this)};function uc(a,b,c){a.R=c?xc(b,!0):b;a.R&&(a.R=a.R.replace(/:$/,""))}function vc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.fa=b}else a.fa=null}function wc(a,b,c){b instanceof yc?a.a=b:(c||(b=zc(b,Fc)),a.a=new yc(b))}
function xc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function zc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Gc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Gc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ac=/[#\/\?@]/g,Cc=/[\#\?:]/g,Bc=/[\#\?]/g,Fc=/[\#\?@]/g,Dc=/#/g;function yc(a){this.b=a||null}yc.prototype.a=null;yc.prototype.c=null;
function Hc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Hc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
yc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};yc.prototype.clone=function(){var a=new yc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Ic(){this.id=this.url=null;this.type="static";this.c=this.j=this.s=null;this.h=5;this.f=this.b=this.g=null;this.i=1;this.a=[]}function Jc(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function Kc(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.j=[];this.a=[]}function Lc(){this.value=null}function Mc(){this.contentType=this.lang=this.id=null}
function Nc(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function Oc(){this.value=this.schemeIdUri=this.b=null;this.children=[];this.a=this.pssh=null}function Pc(){this.parsedPssh=this.psshBox=null}function Qc(){this.url=null}function Rc(){this.url=null}function Sc(){this.s=null;this.g=1;this.c=this.b=this.a=this.f=null}
Sc.prototype.clone=function(){var a=new Sc;a.s=Tc(this.s);a.g=this.g;a.f=this.f;a.a=K(this.a);a.b=K(this.b);a.c=K(this.c);return a};function Uc(){this.a=this.url=null}Uc.prototype.clone=function(){var a=new Uc;a.url=Tc(this.url);a.a=K(this.a);return a};function Vc(){this.a=this.url=null}Vc.prototype.clone=function(){var a=new Vc;a.url=Tc(this.url);a.a=K(this.a);return a};function Wc(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}
Wc.prototype.clone=function(){var a=new Wc;a.s=Tc(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=K(this.h);a.a=Tc(this.a)||[];a.c=K(this.c);return a};function Xc(){this.a=this.b=null}Xc.prototype.clone=function(){var a=new Xc;a.b=Tc(this.b);a.a=K(this.a);return a};function Yc(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}Yc.prototype.clone=function(){var a=new Yc;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=K(this.c);return a};
function Zc(){this.a=[]}Zc.prototype.clone=function(){var a=new Zc;a.a=Tc(this.a)||[];return a};function $c(){this.c=this.a=this.b=null}$c.prototype.clone=function(){var a=new $c;a.b=this.b;a.a=this.a;a.c=this.c;return a};function ad(a,b){this.na=a;this.end=b}ad.prototype.clone=function(){return new ad(this.na,this.end)};Ic.TAG_NAME="MPD";Jc.TAG_NAME="Period";Kc.TAG_NAME="AdaptationSet";Lc.TAG_NAME="Role";Mc.TAG_NAME="ContentComponent";Nc.TAG_NAME="Representation";Oc.TAG_NAME="ContentProtection";
Pc.TAG_NAME="cenc:pssh";Qc.TAG_NAME="BaseURL";Rc.TAG_NAME="Location";Sc.TAG_NAME="SegmentBase";Uc.TAG_NAME="RepresentationIndex";Vc.TAG_NAME="Initialization";Wc.TAG_NAME="SegmentList";Xc.TAG_NAME="SegmentURL";Yc.TAG_NAME="SegmentTemplate";Zc.TAG_NAME="SegmentTimeline";$c.TAG_NAME="S";
Ic.prototype.parse=function(a,b){this.url=a.s;this.id=L(b,"id",M);this.type=L(b,"type",M)||"static";this.c=L(b,"mediaPresentationDuration",bd);this.h=L(b,"minBufferTime",bd,this.h);this.g=L(b,"minimumUpdatePeriod",bd,this.g);this.b=L(b,"availabilityStartTime",cd,this.b);this.f=L(b,"timeShiftBufferDepth",bd,this.f);this.i=L(b,"suggestedPresentationDelay",bd,this.i);var c=a.s,d=N(this,b,Qc);this.s=dd(c,d);if(d=O(this,b,Rc))this.j=ed(c,d.url);this.a=N(this,b,Jc)};
Jc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.start=L(b,"start",bd);this.a=L(b,"duration",bd);var c=N(this,b,Qc);this.s=dd(a.s,c);this.c=O(this,b,Sc);this.f=O(this,b,Wc);this.g=O(this,b,Yc);this.b=N(this,b,Kc);fd(this)};function fd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Kc.prototype.parse=function(a,b){var c=O(this,b,Mc)||{},d=O(this,b,Lc);this.id=L(b,"id",M);this.group=L(b,"group",P);this.lang=L(b,"lang",M,c.lang);this.contentType=L(b,"contentType",M,c.contentType);this.width=L(b,"width",Q);this.height=L(b,"height",Q);this.b=L(b,"mimeType",M);this.i=L(b,"codecs",M);this.c=d&&"main"==d.value;this.lang&&(this.lang=Sa(this.lang));c=N(this,b,Qc);this.s=dd(a.s,c);this.j=N(this,b,Oc);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?gd(this,
b,a.c):O(this,b,Sc);this.g=a.f?gd(this,b,a.f):O(this,b,Wc);this.h=a.g?gd(this,b,a.g):O(this,b,Yc);this.a=N(this,b,Nc);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Lc.prototype.parse=function(a,b){this.value=L(b,"value",M)};Mc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.lang=L(b,"lang",M);this.contentType=L(b,"contentType",M);this.lang&&(this.lang=Sa(this.lang))};
Nc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.bandwidth=L(b,"bandwidth",Q);this.width=L(b,"width",Q,a.width);this.height=L(b,"height",Q,a.height);this.f=L(b,"mimeType",M,a.b);this.h=L(b,"codecs",M,a.i);this.lang=a.lang;var c=N(this,b,Qc);this.s=dd(a.s,c);this.c=N(this,b,Oc);this.g=a.f?gd(this,b,a.f):O(this,b,Sc);this.b=a.g?gd(this,b,a.g):O(this,b,Wc);this.a=a.h?gd(this,b,a.h):O(this,b,Yc);this.c=this.c.concat(a.j)};
Oc.prototype.parse=function(a,b){this.b=b;this.schemeIdUri=L(b,"schemeIdUri",M);this.value=L(b,"value",M);var c=L(b,"cenc:default_KID",M);c&&(this.a=c.replace(/[-]/g,""));this.pssh=O(this,b,Pc);this.children=Array.prototype.slice.call(b.childNodes)};Pc.prototype.parse=function(a,b){var c=hd(b);if(c){this.psshBox=Da(c);try{this.parsedPssh=new hc(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Qc.prototype.parse=function(a,b){this.url=hd(b)};
Rc.prototype.parse=function(a,b){this.url=hd(b)};Sc.prototype.parse=function(a,b){this.s=a.s||this.s;this.g=L(b,"timescale",Q,this.g);this.f=L(b,"presentationTimeOffset",P,this.f);this.a=L(b,"indexRange",id,this.a);this.b=O(this,b,Uc)||this.b;this.c=O(this,b,Vc)||this.c};Uc.prototype.parse=function(a,b){var c=L(b,"sourceURL",M);this.url=ed(a.s,c);this.a=L(b,"range",id,K(a.a))};Vc.prototype.parse=function(a,b){var c=L(b,"sourceURL",M);this.url=ed(a.s,c);this.a=L(b,"range",id)};
Wc.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=L(b,"timescale",Q,this.f);this.g=L(b,"presentationTimeOffset",P,this.g);this.b=L(b,"duration",Q,this.b);this.i=L(b,"startNumber",P,this.i);this.h=O(this,b,Vc)||this.h;var c=N(this,b,Xc);this.a=c&&0<c.length?c:this.a;this.c=O(this,b,Zc)||this.c};Xc.prototype.parse=function(a,b){var c=L(b,"media",M);this.b=ed(a.s,c);this.a=L(b,"mediaRange",id)};
Yc.prototype.parse=function(a,b){this.b=L(b,"timescale",Q,this.b);this.i=L(b,"presentationTimeOffset",P,this.i);this.a=L(b,"duration",Q,this.a);this.j=L(b,"startNumber",P,this.j);this.h=L(b,"media",M,this.h);this.f=L(b,"index",M,this.f);this.g=L(b,"initialization",M,this.g);this.c=O(this,b,Zc)||this.c};Zc.prototype.parse=function(a,b){this.a=N(this,b,$c)};$c.prototype.parse=function(a,b){this.b=L(b,"t",P);this.a=L(b,"d",P);this.c=L(b,"r",jd)};
function dd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new J(e)):(e=ed(a.slice(0,1),e),c.push(e[0]))}return c}function ed(a,b){if(!b)return a;var c=new J(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function gd(a,b,c){var d=K(c);(b=kd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function O(a,b,c){var d=null;if(b=kd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function kd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function N(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function hd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function Tc(a){return a?a.map(function(a){return a.clone()}):null}function K(a){return a?a.clone():null}
function L(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function cd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function bd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=P(b[1]);c&&(a+=31536E3*c);(c=P(b[2]))&&(a+=2592E3*c);(c=P(b[3]))&&(a+=86400*c);(c=P(b[4]))&&(a+=3600*c);(c=P(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function id(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=P(b[1]);if(null==a)return null;b=P(b[2]);return null==b?null:new ad(a,b)}function jd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Q(a){a=window.parseInt(a,10);return 0<a?a:null}function P(a){a=window.parseInt(a,10);return 0<=a?a:null}function M(a){return a};function ld(a,b){this.url=a;this.b=b||new jb;this.g=this.i=this.h=0;this.a=null;this.c=new x;this.f=null}function jb(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.i=!1}function md(a){nd(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function nd(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}l=ld.prototype;
l.ab=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=Ba(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);md(this);return b}if(0==this.url.lastIndexOf("idb:",0))return od(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;if(this.f&&!this.f.supportsCaching()||this.b.g)a=new J(a),Hc(a.a,"_",Date.now()),a=a.toString();this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.i;this.a.onload=this.kb.bind(this);this.b.g&&(this.a.onreadystatechange=this.ob.bind(this));this.a.onerror=this.Gb.bind(this);this.a.ontimeout=this.tb.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function od(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Eb;return wb(e).then(function(){return Jb(e,c,d)}).then(z(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);F(e);md(this);return a})).catch(z(a,function(a){F(e);md(this);return Promise.reject(a)}))}function pd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Kb=a.a;return b}
l.kb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),md(this)):this.h<this.b.a?qd(this):(a=pd(this,"HTTP error.","net"),this.c.reject(a),md(this))};l.ob=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(xa=a-Date.now())}};l.Gb=function(){var a=pd(this,"Network failure.","net");this.c.reject(a);md(this)};
l.tb=function(){if(this.h<this.b.a)qd(this);else{var a=pd(this,"Request timed out.","net");this.c.reject(a);md(this)}};function qd(a){nd(a);window.setTimeout(a.ab.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function D(a,b,c,d){this.c=b;this.f=c||0;this.h=null!=d?d:null;this.b=this.a=null;this.i=a}function rd(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function kb(a,b,c){if(a.a)return a.a;b=b||new jb;if(a.f||a.h)b.b.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=sd(a,0,b,c);return a.a}D.prototype.g=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=pd(a,"Request aborted.","aborted");a.c.reject(b);md(a)}this.b=null}};
function sd(a,b,c,d){var e=a.c[b].toString();a.i&&(e=a.i(e,c.b)||e);a.b=new ld(e,c);d&&(a.b.f=d);e=a.b.ab().then(z(a,function(a){this.b=this.a=null;return Promise.resolve(a.response)}));return e=e.catch(z(a,function(a){if(this.a&&b+1<this.c.length)return this.a=sd(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}D.prototype.clone=function(){return new D(this.i,this.c.map(function(a){return a.clone()}),this.f,this.h)};D.prototype.toString=function(){return this.c[0].toString()};function td(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,k=(h-1)*e.a,m=k/e.b,k=(k+e.a)/e.b,h=ud(a,b,h-1+e.j,(h-1)*e.a);if(!h)return null;f.push(new vd(m,k,h))}return f}function ud(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new D(a,b.s,0,null):null;c=wd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=rd(b.s,c);return new D(a,b,0,null)}
function wd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new J(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function xd(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function yd(a,b){this.a=new jb;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function zd(a){var b=a.b;return kb(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?O({s:d},a,Ic):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function vd(a,b,c){this.b=a;this.a=b;this.url=c}function Ad(a,b,c){return new vd(b,c,a.url)}function lb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Bd(a,b){return a.map(function(a){return Ad(a,a.b+b,null!=a.a?a.a+b:null)})};function R(a){this.u=a;this.g=0}R.prototype.destroy=function(){this.u=null};l=R.prototype;l.length=function(){return this.u.length};function S(a){if(0==a.u.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.u[0]}function T(a){if(0==a.u.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.u[a.u.length-1]}l.get=function(a){if(0>a||a>=this.u.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.u[a]};
l.ia=function(a){a=lb(this.u,a);return 0<=a?this.u[a]:null};l.Ca=function(a){Cd(this,a);return!0};
function Cd(a,b){a.g!=b.g&&(b=new R(Bd(b.u,a.g-b.g)));if(0==a.length())a.u=b.u.slice(0);else if(0!=b.length()&&null!=T(a).a&&!(null!=T(b).a&&T(b).a<T(a).a)){if(T(a).a<=S(b).b)var c=Ad(T(a),T(a).b,S(b).b),c=a.u.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.u.length&&!(a.u[d].a>=S(b).b);++d);a.u[d].b<S(b).b?(c=Ad(a.u[d],a.u[d].b,S(b).b),c=a.u.slice(0,d).concat([c])):(S(a).b>S(b).b||S(b),c=a.u.slice(0,d))}a.u=c.concat(b.u)}}
l.ha=function(a){var b=a-this.g;if(0==b)return 0;this.u=Bd(this.u,b);this.g=a;return b};l.Ba=function(){return 0<this.length()?{start:S(this).b,end:T(this).a}:{start:0,end:0}};function U(a,b,c,d){R.call(this,a);this.f=b;this.o=c;this.j=d;this.c=this.v=this.b=null;Dd(this)}q(U,R);U.prototype.destroy=function(){this.o=this.f=null;R.prototype.destroy.call(this)};U.prototype.ia=function(a){Ed(this,wa()/1E3);return R.prototype.ia.call(this,a)};U.prototype.Ca=function(a){Cd(this,a);null==this.b&&Dd(this);return!0};
function Dd(a){if(0!=a.length()){a.length();var b=null!=T(a).a?T(a).a:T(a).b;if(a.f.b>a.j)a.b=b;else{var c=a.j-(a.f.b+a.o.start);0>c?a.b=b:c<Math.max(T(a).b,T(a).a||0)?(T(a),a.b=b):a.b=c}a.v=T(a).b;a.c=S(a).b}}U.prototype.ha=function(a){a=R.prototype.ha.call(this,a);Math.min.apply(null,this.u.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.b}));null!=this.b&&(this.v+=a,this.c+=a,this.b+=a);return a};U.prototype.Ba=function(){return Fd(this,wa()/1E3)};
function Fd(a,b){Ed(a,b);if(null==a.b||null==a.v||null==a.c)return{start:0,end:0};var c=b-a.j,d=a.b+c;null!=a.f.f&&(d=d-a.c-a.f.f,0<d&&(a.c+=d));c=a.v+c;c=0<a.length()?null!=T(a).a?Math.min(c,T(a).a):c:a.c;c=Math.max(c,a.c);return{start:a.c,end:c}}function Ed(a,b){if(null!=a.f.f)if(null==a.b)a.length();else{for(var c=a.b+(b-a.j),d=0,e=0;e<a.u.length;++e){var f=null;e<a.u.length-1?f=a.u[e+1].a:(f=a.u[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.f.f)++d;else break}0<d&&a.u.splice(0,d)}};function Gd(a,b,c,d,e){var f=1,g=0,h;if(a.b>d)h=null;else{var k=a.i||0,m=a.f||0;h=c.a;h=h.a/h.b;var p=d-(a.b+b.start);0>p?h=null:(m=p-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,p-=h,0>p?h=null:(k=Math.floor(p/h)*h-k,0>k&&(k=0),k=Math.floor(k/h)*h,h={Ma:m/h+1,current:(k>=m?k:m)/h+1}))}h&&(f=h.Ma,g=h.current-h.Ma+1);f=td(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.l=c;this.i=this.a=0<this.length()?a.b+b.start+T(this).a:null;this.h=
h?h.current+1:null;this.w=e}q(Gd,U);Gd.prototype.destroy=function(){this.w=this.l=null;U.prototype.destroy.call(this)};Gd.prototype.ia=function(a){var b=wa()/1E3;Hd(this,b);Ed(this,b);return R.prototype.ia.call(this,a)};Gd.prototype.Ca=function(a){if(null!=this.a||!(a instanceof Gd)||null==a.a)return!1;this.a=a.a;this.i=a.i;this.h=a.h;Cd(this,a);Hd(this,wa()/1E3);Dd(this);return!0};Gd.prototype.ha=function(a){a=U.prototype.ha.call(this,a);null!=this.a&&(this.a+=a,this.i+=a);return a};
Gd.prototype.Ba=function(){var a=wa()/1E3;Hd(this,a);return Fd(this,a)};function Hd(a,b){if(null!=a.a&&null!=a.i&&null!=a.h){var c=a.l.a,c=c.a/c.b,d=Math.floor((a.i+(b-a.j)-a.a)/c);if(0!=d){var e=td(a.w,a.l,a.h,d);Array.prototype.push.apply(a.u,Bd(e,a.g));a.a+=d*c;a.h+=d}}};function Id(){}
Id.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new ia(a),h=E(g);if(1936286840!=E(g))e=null;else{1==h&&(h=tb(g));var k=na(g);w(g,3);w(g,4);var m=E(g);if(0==m)e=null;else{var p,t;0==k?(p=E(g),t=E(g)):(p=tb(g),t=tb(g));w(g,2);var y=g.b.getUint16(g.a,g.c);g.a+=2;a=p;b=b+h+t;for(h=0;h<y;h++){var u=E(g);t=(u&2147483648)>>>31;var k=u&2147483647,v=E(g);E(g);if(1==t){e=null;break a}var ta=new D(d,c,b,b+k-1);f.push(new vd(a/m,(a+v)/m,ta));a+=v;b+=k}e=f}}}}catch(Fb){if(!(Fb instanceof RangeError))throw Fb;
}return e};function Jd(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}Jd.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Jd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=xd(a.c,a.b||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=ud(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.b;c.push(new vd(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new R(c);return Promise.resolve(this.a)};function Kd(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Kd.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Kd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=xd(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=a.b*a.i:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,k=null,m=null;a.b?(k=c+a.b,m=k/a.f):0<b.length?(k=b[f].end-(a.g||0),m=k/a.f):(m=h+this.b.a,k=m*a.f);var c=k,k=0,p=null;g.a&&(k=g.a.na,p=g.a.end);e.push(new vd(h,m,new D(this.f,g.b,
k,p)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new R(e);return Promise.resolve(this.a)};function Ld(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}Ld.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
Ld.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new Gd(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=td(this.g,this.c,1,Math.ceil(this.b.a/(b.a/b.b)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Ad(c,c.b,this.b.a)}b=new R(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function Md(a){this.a=a}Md.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)};Md.prototype.create=function(){return this.a?kb(this.a):Promise.resolve(null)};function Nd(){this.A=Od++;this.id=this.C=this.G=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.L=!1;this.J=!0}var Od=0;Nd.prototype.destroy=function(){this.G&&(this.G.destroy(),this.G=null);this.C&&(this.C.destroy(),this.C=null)};function Zd(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function $d(){this.A=ae++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var ae=0;
$d.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function be(a){for(var b=[],c=0;c<a.a.length;++c){var d=new ce;d.id=a.A;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?Zd(a.m[0]):"";b.push(d)}return b}function de(){this.id=null;this.start=0;this.b=null;this.a=[]}de.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ee(){this.b=!1;this.g=this.f=null;this.c=0;this.a=[]}
ee.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ce(){this.id=0;this.a=null;this.b=this.contentType=""};function fe(){}
fe.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new ha(b);if(440786851!=r(g).id)f=null;else{var h=r(g);if(408125543!=h.id)f=null;else{var k=h.a.byteOffset,m;var p=new ha(h.a);for(b=null;sb(p.a);){var t=r(p);if(357149030==t.id){b=t;break}}if(b){for(var y=new ha(b.a),p=1E6;sb(y.a);){var u=r(y);if(2807729==u.id){p=oa(u);break}}m=p/1E9}else m=null;f=m?{Cb:k,Hb:m}:null}}if(f){var v=r(new ha(a));if(475249515!=v.id)e=null;else{var ta=f.Cb,Fb=f.Hb;a=[];var Pd=new ha(v.a);for(f=v=-1;sb(Pd.a);){var Qd=
r(Pd);if(187==Qd.id){var Ja;var Rd=new ha(Qd.a),Sd=r(Rd);if(179!=Sd.id)Ja=null;else{var cf=oa(Sd),Td=r(Rd);if(183!=Td.id)Ja=null;else{for(var Ud=new ha(Td.a),k=0;sb(Ud.a);){var Vd=r(Ud);if(241==Vd.id){k=oa(Vd);break}}Ja={Jb:cf,Bb:k}}}if(Ja){var Wd=Fb*Ja.Jb,Xd=ta+Ja.Bb;if(0<=v){var Ec=new D(d,c,f,Xd-1);a.push(new vd(v,Wd,Ec))}v=Wd;f=Xd}}}0<=v&&(Ec=new D(d,c,f,null),a.push(new vd(v,null,Ec)));e=a}}else e=null}catch(Yd){if(!(Yd instanceof RangeError))throw Yd;}return e};function ge(a,b,c,d,e,f,g){this.g=a;this.j=b;this.f=c;this.a=d;this.c=e;this.v=f;this.i=this.b=null;this.h=g}ge.prototype.destroy=function(){this.h=this.j=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.i&&(this.i.destroy(),this.i=null);this.b=null};
ge.prototype.create=function(){if(this.b)return this.b;var a=[kb(this.a)];"webm"==this.f&&a.push(kb(this.c));return this.b=Promise.all(a).then(z(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Id,d=d.parse(new DataView(c),this.a.f,this.a.c,this.h)):"webm"==this.f&&(d=new fe,d=d.parse(new DataView(c),new DataView(a),this.a.c,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.j,this.v):e=new R(d);return Promise.resolve(e)}))};function he(a){this.b=a;this.a=null}he.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};he.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new vd(0,null,this.b);this.a=new R([a]);return Promise.resolve(this.a)};function ie(a){this.a=a}
function je(a,b,c){for(var d=wa()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var k=0;k<h.a.length;++k){var m=h.a[k],p=0,p=p+(m.g?1:0),p=p+(m.b?1:0),p=p+(m.a?1:0);0==p?(h.a.splice(k,1),--k):1!=p&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}ke(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){k=h=f.b[g];m=null;for(p=0;p<k.a.length;++p){var t=k.a[p].f||"";m?t!=m&&(k.a.splice(p,1),--p):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.b&&(b.b=d);e=new ee;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new D(c,b.j||b.url));e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=le(a,b,g,d,c);e.a.push(g)}return e}
function ke(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null);b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.c};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.c)||(e=a.a[a.a.length-1],d?a.c=c:b(e.start)&&b(e.a)?a.c=e.start+e.a:"dynamic"!=a.type&&
(a.c=c))}}function le(a,b,c,d,e){var f=new de;f.id=c.id;f.start=c.start;f.b=c.a;var g=new A;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=Ha(g),k=0;k<h.length;++k){var m=new A;g.get(h[k]).forEach(function(a){m.push(a.group,a)});for(var p=Ha(m),t=0;t<p.length;++t){var y=new A;m.get(p[t]).forEach(function(a){y.push(a.lang,a)});for(var u=Ha(y),v=0;v<u.length;++v){var ta=y.get(u[v]),ta=me(a,b,c,ta,d,e);f.a.push(ta)}}}return f}
function me(a,b,c,d,e,f){Oa(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new $d,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},k=0;k<d.length;++k)for(var m=d[k],p=0;p<m.a.length;++p){var t=m.a[p],y=ne(a,t),u=g.a.slice(0);
oe(y,u);0==u.length&&0<g.a.length||!(t=pe(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.A]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.L=!0}),g;a=qe(d);for(k=0;k<g.m.length;++k)t=g.m[k],m=h[t.A],m==a&&(t.L=!0);return g}function qe(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function oe(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.j==g.j&&f.g==g.g&&f.v==g.v&&f.f==g.f&&f.i==g.i&&la(f.c,g.c)){d=!0;Mb(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function ne(a,b){var c=[];if(0==b.c.length)c.push(new Kb);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,re(a,b.c[d]));return c}
function re(a,b){var c=[];if(2==a.a.length){var d=a.a(b.schemeIdUri,b.b);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=Lb(d[e]);0==f.b.length&&b.pssh&&b.pssh.psshBox&&Mb(f,[{initData:b.pssh.psshBox,initDataType:"cenc"}]);c.push(f)}}else{d=a.a(b);if(!(d&&d instanceof Nb))return[];e=new Kb;e.a=d.g;e.h=d.j;e.j=d.o;e.l=d.h;e.o=d.i;e.g=d.f;e.v=d.v;e.f=d.c;e.i=d.l;e.c=d.b?new Uint8Array(d.b.buffer):null;Mb(e,d.a);c.push(e)}return c}
function pe(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new Uc,h.url=c.s,h.a=g.a?g.a.clone():null),h=se(h,e),g=g.c?se(g.c,e):null,a=new ge(a,b,f,h,g,d,e),b=new Md(g),d=new Nd,d.G=a,d.C=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?se(f.h,e):null,a=new Kd(a,b,c,d,e),b=
new Md(f),d=new Nd,d.G=a,d.C=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.a?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.a=null):f.c&&(f.a=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?te(c,f,Vc):null,!g)){f=null;break a}f=g?se(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?ud(e,c,1,0)?(h=(h=c.a.f)?te(c,h,Uc):null)?(h=se(h,e),a=new ge(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new Jd(a,b,c,d,e):g.a?"dynamic"!=a.type&&null==b.a?null:
new Ld(a,b,c,d,e):null:null;a?(b=new Md(f),d=new Nd,d.G=a,d.C=b,f=d):f=null}else f=null;g=c.a.b;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new Nd,f.G=new he(new D(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.a&&f.f.push(b.a);return f}function te(a,b,c){b=wd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=rd(a.s,b);return c}
function se(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.na,e=a.a.end);return new D(b,c,d,e)};function ue(a,b){C.call(this,a);this.b=b;this.g=!0;this.h=this.f=null;this.c=new x;this.a=null}q(ue,C);ue.prototype.H=function(){};ue.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.v=this.b=this.f=this.h=this.a=this.c=null};l=ue.prototype;l.oa=function(){return this.f};l.Pa=function(){return this.h};l.bb=function(){return this.c};l.Qa=function(){return!0};
l.ra=function(a){a.G.create().then(z(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.h=b;b=S(b).url.c[0].toString();var d=this.Aa();this.a&&(this.wa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.wa(d);b=G({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};l.Va=function(){};
l.wa=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};l.Aa=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function ve(a,b,c,d,e){C.call(this,a);this.c=b;this.a=new db(c,d,e);this.w=this.F=this.b=null;this.I=!1;this.g=null;this.l=!1;this.i=null;this.o=!1;this.h=new x;this.j=this.f=!1;this.B=0;this.K=15;this.D=!1}q(ve,C);ve.prototype.H=function(a){null!=a.initialStreamBufferSize&&(this.B=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.K=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.l=Number(a.segmentRequestTimeout))};
ve.prototype.destroy=function(){we(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.v=this.c=this.a=null};l=ve.prototype;l.oa=function(){return this.b};l.Pa=function(){return this.F};l.bb=function(a){this.f||a.then(function(){this.f=!0;this.g||xe(this,0)}.bind(this)).catch(function(){});return this.h};l.Qa=function(){return this.j};
l.ra=function(a,b,c){if(a!=this.b){var d=[a.G.create(),a.C.create()];Promise.all(d).then(z(this,function(d){if(this.c){var f=this.b;this.b=a;this.F=d[0];this.w=d[1];this.I=!0;this.l||(f?b&&ye(this,!0,c):xe(this,0))}})).catch(z(this,function(a){"aborted"!=a.type&&(this.f?(a=H(a),this.dispatchEvent(a)):this.h.reject(a))}))}};l.Va=function(){return ye(this,!1)};
function ye(a,b,c){a.b&&!a.l&&(a.l=!0,we(a),fb(a.a).then(z(a,function(){var a=this.c.currentTime;if(!b&&0<gb(this.a,a)&&0<=lb(this.a.b,a))return Promise.resolve();if(c)return ob(this.a,this.c.currentTime+c);this.D=!0;return nb(this.a)})).then(z(a,function(){this.l=!1;xe(this,0)})).catch(z(a,function(a){this.l=!1;this.f?(a=H(a),this.dispatchEvent(a)):this.h.reject(a)})))}l.wa=function(){};l.Aa=function(){return!0};
l.wb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)ye(this,!0);else{this.g=null;a=this.b;var b=this.F,c=this.c.currentTime;gb(this.a,this.o?c:c+(this.i||0))>=(this.o?Math.max(this.B,this.K):this.B)?(ze(this),xe(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Ae(this,c,b))?(b=hb(this.a,b,a.c,this.w),this.w=null,this.I&&(this.I=!1,Be(this,a)),this.j=!1,b.then(z(this,function(a){null==this.i&&(this.i=a);this.D&&0<gb(this.a,c)&&(this.D=
!1,this.c.currentTime+=.001);xe(this,0)})).catch(z(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Kb.status)&&this.b&&xe(this,5E3);a=H(a);this.dispatchEvent(a)}}))):(ze(this),this.f&&!this.j&&(this.j=!0,Ce(this)),xe(this,1E3))}}};function Ae(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ia(a.a):null:c.ia(b)||(c.length()?T(c):null)}
function ze(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.o;0!=d&&(b.b=Bd(b.b,d),b.o=c);a.h.resolve(a.i)}}function Be(a,b){var c;c=b.a.split("/")[0];c=G({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Ce(a){var b=G({type:"ended"});a.dispatchEvent(b)}function xe(a,b){a.g=window.setTimeout(a.wb.bind(a),b)}function we(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function De(a){this.b=a;this.a=null}De.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};De.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new vd(c.start_time,c.end_time,new D(null,[new J(c.url)],c.start_byte,null)))}this.b=null;this.a=new R(a);return Promise.resolve(this.a)};function Ee(a,b){vb.call(this,"readwrite",b);this.j=a;this.b=0}q(Ee,vb);
function Fe(a,b,c,d,e){for(var f=[],g=[],h=0,k=0,m=[],p=b.map(function(a){return a.G.create()}),p=Promise.all(p),t=b.map(function(a){return a.C.create()}),t=Promise.all(t),p=Promise.all([p,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)p=p.then(function(a){return Ge(this,b[a],f[a],g[a],h,k)}.bind(a,t)),p=p.then(function(a,b){k+=f[a].length();m.push(b)}.bind(a,t));return p.then(z(a,function(){return He(Bb(this))})).then(z(a,function(a){var b=
new x;c=pa(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.j,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.i},g=Bb(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function Ie(a,b){return Cb(Bb(a),b).then(z(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(Je(this,a.stream_ids[e]));a=Bb(this);d.push(a.delete(b));return Promise.all(d)}))}
function Ge(a,b,c,d,e,f){var g=[He(Ab(a)),He(yb(a).index("stream"))],g=Promise.all(g).then(z(a,function(a){return{qa:Math.max(a[0],a[1]),ga:new ArrayBuffer(0),Da:0,u:[],za:null,Ib:e,Ua:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function He(a){var b=new x,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
Ee.prototype.g=function(a,b,c){var d=new x;a={stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.u};var e=Ab(this).put(a);e.onsuccess=function(){d.resolve(c.qa)};e.onerror=function(){d.reject(e.error)};return d};Ee.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(z(this,function(a){Je(this,b.qa);return Promise.reject(a)}))};
Ee.prototype.c=function(a,b,c,d){var e=new x;0==b.ga.byteLength&&(b.za=a);b.ga=Ke(b.ga,d);b.Ua++;var f=G({type:"progress",detail:b.Ua/b.Ib*100,bubbles:!0});if(1048576<=b.ga.byteLength||c){c={stream_id:b.qa,segment_id:b.Da,content:b.ga};var g=yb(this).put(c);b.u.push({start_time:b.za.b,start_byte:b.za.url.f,end_time:a.a,url:"idb://"+b.qa+"/"+b.Da});b.Da++;b.ga=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=z(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function Ke(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}Ee.prototype.i=function(a){var b=new jb;b.c=1E3*this.b;return kb(a.url,b,this.j)};
function Je(a,b){var c=new x,d=Ab(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=yb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function Le(a,b,c,d,e,f){this.b=new D(null,[new J(a)]);this.a=new jb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.i=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Me(a){return kb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Ne(a,b,c){C.call(this,a);this.g=b;this.b=c;this.a=this.h=null;this.l=new Wa;this.j={};this.f=[];this.o=0;this.c=new x;this.i=null;this.w=0}q(Ne,C);Ne.prototype.destroy=function(){this.v=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.j=this.a=this.h=null;this.c.destroy();this.c=null;this.l.destroy();this.l=null;this.i&&(window.clearTimeout(this.i),this.i=null);this.g=this.b=null};
Ne.prototype.initialize=function(){for(var a=new A,b=this.b.Oa(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Oe(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.v||this.b.ea()?"required":"optional",sessionTypes:[this.b.ea()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var k;"audio"==f.contentType?k=f.a.f:"video"==f.contentType&&(k=f.a.i);h[g].push({contentType:f.b,robustness:k})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Ea(a),this.c.resolve(),Promise.resolve();k=new x;c=Pe(this,c,k);c=c.then(this.gb.bind(this,b,a));c=c.then(this.Db.bind(this));k.reject(null);return c};
function Qe(a,b){null==a.i&&(a.i=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function Re(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function Pe(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ea()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}l=Ne.prototype;
l.gb=function(a,b,c){if(!this.g)return Se();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var k=e[h+"Capabilities"];if(k&&k.length){for(var k=k[0],m=[],p={},t=0;t<a.length;++t){var y=a[t];if(y.a.a==d&&y.b==k.contentType&&!(y.id in p)){m.push(y);p[y.id]=!0;var u;if(this.a){u=this.a;var y=y.a,v=new Kb;v.a=u.a;v.h=u.h;v.j=u.j;v.l=u.l;v.o=u.o;v.g=u.g;v.v=u.v;v.f=u.f;v.i=u.i;v.c=u.c?new Uint8Array(u.c.buffer):null;Mb(v,u.b);Mb(v,
y.b);u=v}else u=y.a;this.a=u}}b.a[h]=m}}}this.b.Ea(b);return c.createMediaKeys()};
l.Db=function(a){if(!this.g)return Se();this.h=a;return this.g.setMediaKeys(this.h).then(z(this,function(){return this.g?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():Se()})).then(z(this,function(){if(!this.g)return Se();if(0<this.b.va().length)Te(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Ra({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&B(this.l,this.g,"encrypted",this.Ra.bind(this))}}))};
function Se(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}l.Ra=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.j[c]){try{var d=Ue(this)}catch(e){d=H(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.j[c]=!0;a.catch(z(this,function(a){if(this.j){this.j[c]=!1;var b=H(a);this.dispatchEvent(b);this.c.reject(a)}}));this.f.push(d)}};
function Te(a){for(var b=a.b.va(),c=0;c<b.length;++c){var d=Ue(a),e=d.load(b[c]);a.f.push(d);e.then(z(a,function(){this.o++;this.o>=this.f.length&&this.c.resolve()})).catch(z(a,function(a){a=H(a);this.dispatchEvent(a)}))}}
function Ue(a){var b=null;if(a.b.ea())try{b=a.h.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.h.createSession();B(a.l,b,"message",a.rb.bind(a));B(a.l,b,"keystatuseschange",a.jb.bind(a));return b}l.rb=function(a){Ve(this,a.target,this.a,a.message)};l.jb=function(a){a=a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d=c.next()){var e=Ea(new Uint8Array(d.value)),d=a.get(d.value);b[e]=d}this.b.Sa(b)};
function Ve(a,b,c,d){d=We(c,d);Me(new Le(d.url,d.body,d.method,c.j,d.headers,a.w)).then(z(a,function(a){c.l&&(a=c.l(a));return b.update(a)})).then(z(a,function(){var a=G({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.c.resolve()})).catch(z(a,function(a){a.Mb=b;a=H(a);this.dispatchEvent(a)}))}
function We(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if(!a.o)return c;a.o(c);c.url=ua(c,"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=ua(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=va(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c};function Xe(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Ye(a,b){var c=new Ze(b);a.streamHistory.push(new $e(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function Ze(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function $e(a){this.timestamp=wa()/1E3;this.value=a};function V(a){C.call(this,null);this.a=a;this.b=null;this.f=new Wa;this.j=this.l=null;this.H=0;this.B=null;this.i=!1;this.g=new Xe;this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new Na};this.o=1;this.F=null}q(V,C);n("shaka.player.Player",V);V.version="1.5.2-npm-dirty";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Oe(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Oe;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+mc(a)+" }",0)};V.prototype.destroy=function(){return this.w().then(z(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.w=function(){if(!this.b)return Promise.resolve();this.i&&af(this);this.a.pause();Xa(this.f);bf(this);df(this);this.l&&(this.l.destroy(),this.l=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.i=!1;this.g=new Xe;return a};V.prototype.unload=V.prototype.w;
V.prototype.ma=function(a){var b=this.w();this.a.autoplay&&(oc("load"),B(this.f,this.a,"timeupdate",this.ib.bind(this)));a.K(this.c);a.Za(this.F);this.F=null;b=b.then(z(this,function(){return a.U()}));b.catch(z(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(z(this,function(){if(!this.a)return ef();this.b=a;B(this.f,this.b,"seekrangechanged",this.pb.bind(this));this.l=new Ne(this,this.a,this.b);return this.l.initialize()})).then(z(this,function(){if(!this.a)return ef();B(this.f,
this.a,"error",this.Eb.bind(this));B(this.f,this.a,"playing",this.nb.bind(this));B(this.f,this.a,"pause",this.mb.bind(this));return this.b.Ja(this,this.a)})).then(z(this,function(){if(!this.a)return ef();ff(this)})).catch(z(this,function(a){if(!this.a)return ef();if("destroy"!=a.type){var b=H(a);this.dispatchEvent(b)}return this.w().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ma;
function ef(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}l=V.prototype;l.ib=function(){rc("load");this.g.playbackLatency=sc("load")/1E3;this.f.sa(this.a,"timeupdate")};l.Eb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(gf[a]||"Unknown playback error."),a.type="playback",a=H(a),this.dispatchEvent(a))}};
l.nb=function(){oc("playing");!this.j&&0>this.o&&(this.a.playbackRate=0,this.D(this.a.currentTime,Date.now(),this.o));this.i&&af(this)};l.mb=function(){rc("playing");var a=sc("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}df(this)};l.pb=function(a){this.H=a.start};
l.$a=function(){if(!this.a.paused){rc("playing");var a=sc("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;oc("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.$a;V.prototype.la=function(){return this.b?this.b.ja():[]};V.prototype.getVideoTracks=V.prototype.la;V.prototype.ta=function(){return this.b?this.b.pa():[]};
V.prototype.getAudioTracks=V.prototype.ta;V.prototype.ka=function(){return this.b?this.b.Ga():[]};V.prototype.getTextTracks=V.prototype.ka;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.ya=function(a,b){return this.b?this.b.Xa(a,void 0==b?!0:b):!1};V.prototype.selectAudioTrack=V.prototype.ya;V.prototype.eb=function(a){return this.b?this.b.Ya(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.eb;V.prototype.T=function(a){this.b&&this.b.Fa(a)};V.prototype.enableTextTrack=V.prototype.T;V.prototype.K=function(a){this.h({enableAdaptation:a})};V.prototype.enableAdaptation=V.prototype.K;V.prototype.S=function(){return this.c.enableAdaptation};V.prototype.getAdaptationEnabled=V.prototype.S;V.prototype.da=function(a){this.h({streamBufferSize:a})};V.prototype.setStreamBufferSize=V.prototype.da;V.prototype.X=function(){return Number(this.c.streamBufferSize)};
V.prototype.getStreamBufferSize=V.prototype.X;V.prototype.fb=function(a){this.h({licenseRequestTimeout:a/1E3})};V.prototype.setLicenseRequestTimeout=V.prototype.fb;V.prototype.Z=function(a){this.h({mpdRequestTimeout:a/1E3})};V.prototype.setMpdRequestTimeout=V.prototype.Z;V.prototype.M=function(a){this.h({segmentRequestTimeout:a/1E3})};V.prototype.setRangeRequestTimeout=V.prototype.M;V.prototype.ca=function(a){this.h({preferredLanguage:a})};V.prototype.setPreferredLanguage=V.prototype.ca;
V.prototype.ba=function(a){df(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.D(this.a.currentTime,Date.now(),a));this.o=a};V.prototype.setPlaybackRate=V.prototype.ba;V.prototype.V=function(){return this.o};V.prototype.getPlaybackRate=V.prototype.V;V.prototype.O=function(a){this.h({restrictions:a})};V.prototype.setRestrictions=V.prototype.O;V.prototype.W=function(){return this.c.restrictions.clone()};V.prototype.getRestrictions=V.prototype.W;
V.prototype.cb=function(a){this.F=a};V.prototype.setPlaybackStartTime=V.prototype.cb;V.prototype.I=function(){return this.b?this.b.Wa():!1};V.prototype.isLive=V.prototype.I;
V.prototype.h=function(a){if(a){var b=sa(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=ra(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=ra(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=ra(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=ra(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=ua(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=b);a=va(a,"restrictions",Na);null!=a&&(this.c.restrictions=
a.clone());this.b&&this.b.K(this.c)}};V.prototype.configure=V.prototype.h;V.prototype.ua=function(){return this.c};V.prototype.getConfiguration=V.prototype.ua;function df(a){a.j&&(window.clearTimeout(a.j),a.j=null)}function ff(a){bf(a);a.B=window.setTimeout(a.Y.bind(a),100)}function bf(a){a.B&&(window.clearTimeout(a.B),a.B=null)}
V.prototype.D=function(a,b,c){this.j=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.H+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.H,a+d),this.a.currentTime=d,this.j=window.setTimeout(this.D.bind(this,a,b,c),250))};function af(a){rc("buffering");var b=a.g;b.bufferingTime+=sc("buffering")/1E3;a.i=!1;a.dispatchEvent(G({type:"bufferingEnd"}))}
V.prototype.Y=function(){ff(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0);if(this.i)a>this.b.Na()&&(af(this),this.a.play());else{var c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;!this.a.paused&&!b&&.2>a&&(this.i=!0,this.a.pause(),this.g.bufferingHistory.push(wa()/1E3),oc("buffering"),this.dispatchEvent(G({type:"bufferingStart"})))}}};
var gf={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function hf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Oe(Zd(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function jf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(kf)}function kf(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function lf(a){this.a=a}lf.prototype.destroy=function(){this.a.destroy();this.a=null};function mf(a,b){var c=nf(b),d=nf(a.a);return Promise.all([c,d]).then(z(a,function(a){var c=a[0];a=a[1];var d=this.a.a;hf(d);jf(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];of(b,this.a,c,a,d);c=b.a;hf(c);jf(c);return Promise.resolve(d)}))}
function nf(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.G.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].A]=a[f];return Promise.resolve(b)})}
function of(a,b,c,d,e){var f=new A;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new A;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=Ha(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(pf(k[0],h[0],c,d,e),k[0].b=h[0].b)}}
function pf(a,b,c,d,e){var f=new A;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new A;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=Ha(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&qf(k[0],h[0],c,d,e)}}
function qf(a,b,c,d,e){var f=new A;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new A;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=Ha(f),k=0;k<h.length;++k){var m=h[k];b[m]=m;var p=f.get(m);1<p.length||((m=g.get(m))&&0!=m.length?1==m.length&&(rf(p[0],m[0],c,d),p[0].C=m[0].C,m[0].C=null,p[0].c=m[0].c):(e.push(p[0]),a.m.splice(a.m.indexOf(p[0]),1)))}h=Ha(g);for(k=0;k<h.length;++k)m=h[k],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function rf(a,b,c,d){a=c[a.A];b=d[b.A];a.length();a.Ca(b)&&a.length()};function W(){this.a=this.b=null;this.f=new Wa;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}n("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,B(this.f,this.b,"bandwidth",this.v.bind(this)),B(this.f,this.a,"adaptation",this.j.bind(this)),B(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=sf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.v=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=sf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function sf(a){var b=a.a.ja();if(0==b.length)return null;b.sort(Ka);var c;a:{c=a.a.pa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function X(a,b,c){C.call(this,null);this.a=a;this.X=b;this.i=new Wa;this.g=new MediaSource;this.f=null;this.ba=0;this.b=new A;this.H=c;this.H.initialize(b,this);this.I=!1;this.F="en";this.da=!1;this.S=null;this.w=new x;this.h=new Na;this.B=null;this.ua=1;this.c={};this.ca=new x;this.V=0;this.ta=!1;this.o={};this.Y=this.W=this.Z=null;this.D={}}q(X,C);n("shaka.player.StreamVideoSource",X);
X.prototype.K=function(a){null!=a.streamBufferSize&&(this.D.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.D.segmentRequestTimeout=a.segmentRequestTimeout);tf(this);null!=a.enableAdaptation&&this.H.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ba=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.F=Sa(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.I&&uf(this))};
X.prototype.destroy=function(){this.w.destroy();this.ca.destroy();this.ca=this.w=null;this.W&&(window.clearTimeout(this.W),this.W=null);this.Z&&(window.clearTimeout(this.Z),this.Z=null);this.o=null;this.i.destroy();this.i=null;qa(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.H.destroy();this.v=this.h=this.S=this.f=this.g=this.X=this.H=null};l=X.prototype;
l.Ja=function(a,b){if(!this.I){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.v=a;this.f=b;this.S=a.$a();B(this.i,this.g,"sourceopen",this.lb.bind(this));B(this.i,this.X,"bandwidth",this.Fb.bind(this));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.w,c])};
l.U=function(){if(this.I){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;hf(a);jf(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.I=!0;this.D.initialStreamBufferSize=this.a.c;tf(this);uf(this);
return Promise.resolve()};l.ub=function(){var a=Date.now(),b=this.Z=null;this.Ta(this.a.g).then(z(this,function(a){b=new lf(a);return mf(b,this.a)})).then(z(this,function(c){b.destroy();b=null;for(var d=0;d<c.length;++d)vf(this,c[d]);this.D.initialStreamBufferSize=this.a.c;tf(this);uf(this);0==Object.keys(this.c).length?wf(this):xf(this,(Date.now()-a)/1E3)})).catch(z(this,function(a){b&&(b.destroy(),b=null);"aborted"!=a.type&&(a=H(a),this.dispatchEvent(a),this.a&&xf(this,0))}))};l.Ta=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
function vf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.oa()==b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.L&&a.J});if(0==f.length){e.push(b);return}a.o[c].Ha==b&&delete a.o[c];d.ra(f[0],!0);b.destroy()}b.destroy()}
l.ja=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.oa():null)?a.A:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.L&&g.J){var h=g.A,g=new Ia(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ja;
X.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.oa():null)?a.A:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.L&&h.J){var k=h.A,h=new La(k,h.bandwidth,f);k==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.pa;
X.prototype.Ga=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.oa():null,b=b?b.A:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var k=f.m[h].A,m=new Ma(k,g);k==b&&(m.active=!0,m.enabled=a.Aa());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Ga;X.prototype.Na=function(){return Number(this.D.initialStreamBufferSize)};
X.prototype.Oa=function(){var a;if(this.I){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,be(a.a[c]));a=b}else a=[];return a};
X.prototype.Ea=function(a){if(this.I){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.A]=e}this.b.a={};c=Ha(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var k=f[h];k.b.split(";")[0]==g&&this.b.push(e,b[k.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.da=!0;if(a=this.b.get("audio"))yf(this,a),this.b.a.audio=a,a=a[0].lang||this.F,Ra(2,this.F,
a)&&(this.da=!1);if(a=this.b.get("text"))yf(this,a),this.b.a.text=a,a=a[0].lang||this.F,Ra(2,this.F,a)||(this.da=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return zf(this,"video",a,b,c)};l=X.prototype;l.Xa=function(a,b){return zf(this,"audio",a,b)};l.Ya=function(a,b){return zf(this,"text",a,b)};l.Fa=function(a){var b=this.c.text;b&&b.wa(a)};l.Za=function(a){this.Y=a};
function uf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],k=h.J;h.J=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.J=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.J=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.J=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.J=!1);k!=h.J&&(b=!0)}}0!=Fa(a.b).length&&b&&(Af(a),0<a.ja().length||(b=Error("The application has restricted all video tracks!"),
b.type="app",b=H(b),a.dispatchEvent(b)))}}l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return this.a?this.a.b:!1};
l.Sa=function(a){for(var b,c=!1,d=new A,e=Fa(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var k=g.m[h];k.f.forEach(function(a){d.push(a,k)})}for(b in a)if(e=ya[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)k=g[f],h=k.L,k.L=!e,h!=k.L&&(c=!0);else za(b);c&&(Af(this),b=this.pa(),a=this.ja(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="drm",a=H(a),this.dispatchEvent(a))};function Af(a){var b=G({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function zf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],k=0;k<h.m.length;++k){var m=h.m[k];if(m.A==c){if(!m.L||!m.J)return!1;if("text"!=b&&!a.ta)return c=a.o[b],a.o[b]={Ha:m,Ka:null!=c&&c.Ka||d,La:null!=c&&c.La||e},!0;Ye(a.S,m);a.c[b].ra(m,d,e);return!0}}return!1}
function yf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ra(c,a.F,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}l.lb=function(){this.i.sa(this.g,"sourceopen");wf(this).then(z(this,function(){this.w&&this.w.resolve()})).catch(z(this,function(a){this.w&&this.w.reject(a)}))};
function wf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Bf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=qa(f).map(function(a){return a.G.create()});return Promise.all(b).then(z(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Cf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Df(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.H.start();Ef(this,f,a);return Promise.resolve()})).catch(z(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(xf(this,0),Promise.resolve()):Promise.reject(a)}))}
function Bf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.H.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.A==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.L&&a.J});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Df(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new ue(a,a.f):Ff(a,e);if(!e)return qa(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Ff(a,b){var c=new ve(a,a.f,a.g,Zd(b),a.X);c.H(a.D);return c}
function Ef(a,b,c){a.ua=a.f.playbackRate;a.f.playbackRate=0;Gf(a,c);var d;d=a.a.b?c.end:a.Y&&a.Y<=c.end&&a.Y>=c.start?a.Y:c.start;B(a.i,a.f,"seeking",a.qb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.B=d);Hf(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.bb(a.ca));B(a.i,d,"ended",a.sb.bind(a));var f=b[e];Ye(a.S,f);d.ra(f,!1)}Promise.all(c).then(a.hb.bind(a)).catch(z(a,function(a){"destroy"!=a.type&&(a=H(a),this.dispatchEvent(a))}));a.Fa(a.da)}
l.hb=function(a){Oa(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=If(this);for(d=0;d<a.length;++d)a[d].ha(c);Jf(this,a,c);d=Fa(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.G.create()];a.C&&b.push(a.C.create());return Promise.all(b)});Promise.all(d).then(z(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ha(c);this.ta=
!0;for(var d in this.o)a=this.o[d],b=this.c[d],Ye(this.S,a.Ha),b.ra(a.Ha,a.Ka,a.La);this.o={}})).catch(z(this,function(a){"aborted"!=a.type&&(a=H(a),this.dispatchEvent(a))}))};function Jf(a,b,c){if(b=Cf(a,b))Gf(a,b),Hf(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.B=c):c=a.f.currentTime;a.a.b&&b&&(a.V=b.end-c,a.V=Math.max(a.V,0));a.f.playbackRate=a.ua;a.a.b&&null!=a.a.f&&xf(a,a.V);Kf(a);a.ca.resolve()}
function Gf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}l.vb=function(){this.W=null;Kf(this);var a=Cf(this,If(this));a&&(Hf(this,a.start,a.end),this.f.paused||Lf(this,this.f.currentTime,a.start,a.end))};function Hf(a,b,c){b=G({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}
l.qb=function(){var a=this.f.currentTime;if(null!=this.B){if(a>=this.B-.01&&a<=this.B+.01){this.B=null;return}this.B=null}var b=Cf(this,If(this));if(b){var c=b.end;(b=Lf(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Va()}};function Lf(a,b,c,d){if(b>=c-.01)return!1;a.f.currentTime=Math.min(c+(a.a.b?a.a.c:0),d);return!0}l.sb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Qa())return;this.g.endOfStream()}};
l.Fb=function(){var a=this.S,b=this.X.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new $e(b))};function If(a){return qa(a.c).map(function(a){return a.Pa()}).filter(function(a){return null!=a})}
function Cf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e].Ba(),c=Math.max(c,f.start);null!=f.end&&(d=Math.min(d,f.end))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.V),c));return c>d?null:{start:c,end:d}}function xf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.Z=window.setTimeout(a.ub.bind(a),1E3*c)}}function Kf(a){a.a.b&&(a.W=window.setTimeout(a.vb.bind(a),1E3))}
function tf(a){for(var b in a.c)a.c[b].H(a.D)};function Mf(a,b,c){C.call(this,null);this.f=a;this.c=b;this.b=Lb(c);this.a=null}q(Mf,C);n("shaka.player.HttpVideoSource",Mf);Mf.prototype.K=function(){};Mf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.v=this.b=null};l=Mf.prototype;l.Ja=function(a,b){this.v=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};l.U=function(){return Promise.resolve()};
l.ja=function(){return[]};l.pa=function(){return[]};l.Ga=function(){return[]};l.Na=function(){return 5};l.Oa=function(){var a=new ce;a.a=this.b;return[a]};l.Ea=function(){};Mf.prototype.selectVideoTrack=function(){return!1};l=Mf.prototype;l.Xa=function(){return!1};l.Ya=function(){return!1};l.Fa=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};l.Za=function(){};l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return!1};
l.Sa=function(a){for(var b in a){var c=a[b],d=ya[c]||null;if(d){var e=za(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=H(d);this.dispatchEvent(c)}}};function Y(a,b,c){b||(b=new Db);c||(c=new W);X.call(this,null,b,c);this.T=a;this.M=[];this.timeoutMs=3E4;this.l={};this.j=this.O=null}q(Y,X);n("shaka.player.OfflineVideoSource",Y);Y.prototype.K=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.K.call(this,a)};
n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Eb,b=wb(a).then(function(){return Gb(a)});b.then(function(){F(a)}).catch(function(){F(a)});return b});
Y.prototype.ya=function(a,b,c,d){var e,f=null,g={},h=[];a=new D(this.O,[new J(a)]);return zd(new yd(a,this.ba)).then(z(this,function(a){this.a=je(new ie(c),a,this.O);if(this.a.b)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.K({preferredLanguage:b});return X.prototype.U.call(this)})).then(z(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Ne(null,a,this);null!=this.l.licenseRequestTimeout&&(e.w=Number(this.l.licenseRequestTimeout));
B(this.i,e,"sessionReady",this.ka.bind(this));B(this.i,e,"error",function(a){f=a});return e.initialize()})).then(z(this,function(){for(var a=Fa(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var f=c.m[e];g[f.A]=f}return d()})).then(z(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=h.map(function(a){return a.C.create()});
return Promise.all(a)})).then(z(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(Zd(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(z(this,function(){return Qe(e,this.timeoutMs)})).then(z(this,function(){return f?Promise.reject(f):Nf(this,h,e.a,this.a.a[0].b)})).then(z(this,function(a){this.T=a;return f?
(Of(this),Promise.reject(f)):Promise.resolve(a)}))};n("shaka.player.OfflineVideoSource.prototype.store",Y.prototype.ya);Y.prototype.ma=function(a){this.O=a};Y.prototype.setNetworkCallback=Y.prototype.ma;Y.prototype.ka=function(a){this.M.push(a.detail.sessionId)};
function Nf(a,b,c,d){var e=new Ee(a.X,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return wb(e).then(z(a,function(){return Fe(e,b,this.M,d,c)})).then(function(a){F(e);return Promise.resolve(a)}).catch(function(a){F(e);return Promise.reject(a)})}
Y.prototype.U=function(){var a=new Eb,b,c;return wb(a).then(z(this,function(){return Hb(a,this.T)})).then(z(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Ib(a,d.stream_ids[f]));return Promise.all(e)})).then(z(this,
function(a){var e=b,f=c,g=new ee;g.c=5;for(var h=new de,k=0;k<a.length;++k){var m=a[k],p=new Nd,t=new De(m.references),y=new Uint8Array(m.init_segment),y=new J("data:application/octet-stream;base64,"+Ca(y)),y=new Md(new D(this.O,[y],0,null));p.G=t;p.C=y;p.a=m.mime_type;p.b=m.codecs;p.L=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=
this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);m=Lb(f);t=new $d;t.m.push(p);t.a.push(m);t.contentType=p.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.U.call(this)})).then(function(){F(a);return Promise.resolve()}).catch(function(b){F(a);return Promise.reject(b)})};
Y.prototype.la=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return Pf(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(z(this,function(){return Of(this)})).then(function(){return Promise.resolve(c)})};Y.prototype.deleteGroup=Y.prototype.la;Y.prototype.va=function(){return this.M};
Y.prototype.ea=function(){return!0};function Of(a){var b=new Ee(null,null);return wb(b).then(z(a,function(){return Ie(b,this.T)})).then(function(){F(b);return Promise.resolve()}).catch(function(a){F(b);return Promise.reject(a)})}
function Pf(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new Ne(null,b,a);null!=a.l.licenseRequestTimeout&&(c.w=Number(a.l.licenseRequestTimeout));return a.U().then(function(){return c.initialize()}).then(z(a,function(){return Qe(c,this.timeoutMs)})).then(function(){return Re(c)}).then(z(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(z(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};function Z(a,b,c,d){c||(c=new Db);d||(d=new W);X.call(this,null,c,d);this.ka=a;this.M=b;this.l=[];this.O=[];this.T=[];this.j=null}q(Z,X);n("shaka.player.DashVideoSource",Z);Z.prototype.la=function(a,b,c){this.l.push(a);this.O.push(b||"");this.T.push(c||"")};Z.prototype.addExternalCaptions=Z.prototype.la;Z.prototype.ma=function(a){this.j=a};Z.prototype.setNetworkCallback=Z.prototype.ma;Z.prototype.destroy=function(){this.j=this.M=null;X.prototype.destroy.call(this)};
Z.prototype.U=function(){var a=new D(this.j,[new J(this.ka)]);return zd(new yd(a,this.ba)).then(z(this,function(a){for(var c=0;c<this.l.length;c++){var d=a,e=this.l[c],f=this.O[c],g=this.T[c];if(0!==d.a.length){var h=new Kc;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Nc;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new J(e)];h.a.push(f);d.a[0].b.push(h);fd(d.a[0])}}this.a=je(new ie(this.M),a,this.j);return X.prototype.U.call(this)}))};
Z.prototype.Ta=function(a){return zd(new yd(a,this.ba)).then(z(this,function(a){a=je(new ie(this.M),a,this.j);return Promise.resolve(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

